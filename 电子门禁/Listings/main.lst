C51 COMPILER V9.54   MAIN                                                                  01/12/2023 11:58:39 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: C:\keil5\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\main.l
                    -st) TABS(2) OBJECT(.\Objects\main.obj)

line level    source

   1          #include <REGX52.H>
   2          #include <string.h>
   3          #include "Delay.h"
   4          #include "MatrixKey.h"
   5          #include "Nixie.h"
   6          #include "UART.h"
   7          #include "Buzzer.h"
   8          #include "DS18B20.h"
   9          
  10          unsigned char str[10]={'\0'},str1[10]={'\0'},flag1=0,flag2=0,flag_wrong=0,cnt=0,cnt1=0,keynum=20,flagt=0,c
             -h='0'-0,flagn=0,flag=0;
  11          float T;
  12          void main()
  13          {
  14   1        unsigned char i;
  15   1        UART_Init();  //ä¸²å£åˆå§‹åŒ–
  16   1        DS18B20_ConvertT();   //ä¸Šç”µå…ˆè½¬æ¢ä¸€æ¬¡æ¸©åº¦ï¼Œé˜²æ­¢ç¬¬ä¸€æ¬¡è¯»æ•°æ®é”™è¯¯
  17   1        Delay(1000);      //ç­‰å¾…è½¬æ¢å®Œæˆ
  18   1        while(1)
  19   1        {
  20   2          keynum = MatrixKey();
  21   2          DS18B20_ConvertT(); //è½¬æ¢æ¸©åº¦
  22   2          T = DS18B20_ReadT();  //è¯»å–æ¸©åº¦
  23   2          
  24   2          if(T<20)        //æ¸©åº¦åˆ¤æ–­ï¼ŒåŠ ä¸Šflagå½¢å¼ä½¿å¾—ä¸‹åˆ—æ“ä½œå¯ä»¥å±è”½éƒ¨åˆ†åŠŸèƒ½
  25   2            flagt = 1;
  26   2          else flagt = 0;
  27   2          
  28   2          if(flag2)
  29   2          {
  30   3            flag2 = 0;  //ç”¨å®Œå°±ç½®0ï¼Œä¿è¯æ¯æ¬¡åªæ‰§è¡Œä¸€æ¬¡
  31   3            UART_Sendstring("Setok!");
  32   3          }
  33   2          if(keynum>='0' && keynum<='9')  //å‘é€æ•°æ®çš„æ—¶å€™æ˜¯ä»¥æ–‡æœ¬å½¢å¼å‘é€ï¼Œå³å…¨éƒ½æ˜¯å­—ç¬¦å½¢å¼
             -ï¼Œæ‰€ä»¥çŸ©é˜µé”®ç›˜é‡Œé¢çš„å‚æ•°è¦åšå‡ºé€‚å½“è°ƒæ•´ï¼Œå¦åˆ™ä¸‹é¢strcmpå‡½æ•°æ°¸è¿œæ˜¯ä¸ç­‰äº0çš„
  34   2          {
  35   3            str1[cnt++] = keynum; //æŠŠæ¥æ”¶åˆ°çš„æ•°æ®ä»¥å­—ç¬¦çš„æ–¹å¼ä¸€ä¸ªä¸ªä»¥str1æ•°ç»„è®°å½•
  36   3            flag1 = 1;
  37   3          }
  38   2          
  39   2          if(keynum==11)  //ä¸å­˜åœ¨'10','11'...
  40   2            flagn = 1;  //ç¡®è®¤é”®
  41   2          
  42   2          if(keynum==12)  //é‡ç½®é”®
  43   2          {
  44   3            flag1 = 0;    //æŠŠç”¨äºæ•°ç ç®¡å¸¸äº®çš„flagç½®0ï¼Œç›¸å½“äºç†„ç­æ‰€æœ‰æ•°ç ç®¡
  45   3            flag_wrong = 0;
  46   3            cnt = 0;
  47   3            memset(str1,'\0',sizeof(str1));   //æŠŠstr1æ•°ç»„æ¸…0ï¼Œç¡®ä¿ä¸‹æ¬¡é‡æ–°è¾“å…¥æ•°æ®æ—¶æ— è¯¯
  48   3          }
  49   2          
  50   2          if(flag1) //ä¸ºäº†ä¿æŒæ•°ç ç®¡å¸¸äº®ï¼Œéœ€è¦æ ¼å¤–æ‹‰å‡ºæ¥ç”¨flagå½¢å¼åˆ¤æ–­ï¼Œè®©æ¯æ¬¡å¾ªç¯éƒ½è
             -ƒ½è¯»åˆ°ï¼Œè€Œéè°ƒç”¨ä¸€æ¬¡Nixieå‡½æ•°å°±ç»“æŸï¼ˆå¦åˆ™å°±åªä¼šäº®ä¸€æ¬¡
  51   2          {
C51 COMPILER V9.54   MAIN                                                                  01/12/2023 11:58:39 PAGE 2   

  52   3            if(str1[0]!='\0') Nixie(1,str1[0]-ch);  //è¿™é‡Œstr1æ•°ç»„é‡Œçš„å…ƒç´ å·²ç»è½¬åŒ–æˆäº†ASCIIç ï¼Œéœ€è¦
             -å‡å»chå˜å›æ•°å­—å½¢å¼
  53   3            if(str1[1]!='\0') Nixie(2,str1[1]-ch);  //åŠ ifåˆ¤æ–­ï¼Œä¿è¯å…ƒç´ å­˜åœ¨å†æ˜¾ç¤º
  54   3            if(str1[2]!='\0') Nixie(3,str1[2]-ch);
  55   3            if(str1[3]!='\0') Nixie(4,str1[3]-ch);
  56   3          }
  57   2          
  58   2        
  59   2          
  60   2          if(cnt==4 && flagn) //ç”¨&&å®ç°ç¡®è®¤é”®åŠŸèƒ½
  61   2          {
  62   3            flagn = 0;
  63   3            if(strcmp(str1,str)==0)
  64   3            {
  65   4              UART_Sendstring("pwdOK!");
  66   4              if(flagt)
  67   4              {
  68   5                P2 = 0x00;
  69   5                Delay(1000);
  70   5                P2 = 0xFF;
  71   5                Buzzer_Time(2000);
  72   5              }
  73   4            }
  74   3            
  75   3            else if(strcmp(str1,str)!=0)
  76   3            {
  77   4              flag_wrong = 1;
  78   4              UART_Sendstring("Wrong!");
  79   4              if(flagt)
  80   4                for(i=0;i<4;i++)  //ç”¨forå¾ªç¯å®ç°èœ‚é¸£å™¨è¿ç»­å«å››ä¸‹åŠŸèƒ½
  81   4                {
  82   5                  Buzzer_Time(300);
  83   5                  Delay(300);
  84   5                }
  85   4            }
  86   3            cnt = 0;      //æ³¨æ„cntè¦é‡ç½®
  87   3          }
  88   2          
  89   2          if(flag_wrong)  //è¾“å…¥é”™è¯¯æ˜¾ç¤ºE0
  90   2          {
  91   3            Nixie(7,10);
  92   3            Nixie(8,0);
  93   3          }
  94   2        }
  95   1      }
  96          
  97          void UART_Routine() interrupt 4
  98          {
  99   1        unsigned char bytedata = '\0';
 100   1        if(RI==1)         //å¦‚æœæ¥æ”¶æ ‡å¿—ä½ä¸º1ï¼Œæ¥æ”¶åˆ°äº†æ•°æ®
 101   1        {
 102   2          bytedata = SBUF;
 103   2          
 104   2          if(bytedata != '\n')
 105   2          {
 106   3            if(cnt1<4)
 107   3              str[cnt1++] = bytedata;
 108   3            if(cnt1==4)   //ä¸èƒ½ç”¨else ifï¼Œç¬‘æ­»äº†ï¼Œè¿˜åœ¨è¿™é‡ŒçŠ¯è¿‡é”™
 109   3              flag2 = 1;  //æ·¦ï¼Œè¿™é‡Œä¸èƒ½ç”¨UART_Sendstringï¼Œå› ä¸ºSBUFçš„è¯»å’Œå†™ä¸èƒ½åŒæ—¶è¿›è¡Œï¼Œè¯»çš„æ
             -—¶å€™ä¸èƒ½å†™ï¼Œå¦åˆ™å°±ç®—å‘é€ä¹Ÿä¸€ç›´éƒ½æ˜¯ç¬¬ä¸€æ¬¡å‘é€çš„æ•°æ®ï¼Œå…·ä½“çœ‹å…¶æµç¨‹å›¾ï¼
 110   3          }
 111   2          else  
C51 COMPILER V9.54   MAIN                                                                  01/12/2023 11:58:39 PAGE 3   

 112   2          {
 113   3            cnt1 = 0;
 114   3          }
 115   2          RI=0;         //æ¥æ”¶æ ‡å¿—ä½æ¸…0
 116   2        }
 117   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    427    ----
   CONSTANT SIZE    =     21    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     34       1
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
